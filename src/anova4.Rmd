---
title: "Evidence, part 5"
author: "Andy Wills"
output: html_document
---

```{r setup, include=FALSE}
## DEVELOPERS: Uncomment one option, as appropriate

## Show only commands.
## knitr::opts_chunk$set(echo = TRUE, message = FALSE, results='hide', fig.keep = 'none', comment=NA)

## Show commands and putout.
knitr::opts_chunk$set(echo = TRUE, comment=NA, cache = TRUE)


```

For the previous parts of this worksheet, see the [Absolute Beginners' Guide to R](evidence.html), and the [evidence, part 2](anova1.html), [evidence, part 3](anova2.html) and [evidence, part 4](anova3.html) worksheets.

# Contents

- [Getting started](#start)

- [Introduction](#intro)

- [Defining factors](#factors) 

- [Bayesian factorial ANOVA](#bfact)

- [Exercise](#ex1)

- [Pairwise comparisons](#pairc)

- [Better graphs](#bettergraphs)

- [Reporting Bayesian ANOVA](#report)

- [Ordinal factors](#ordinal)

<a name="intro"></a>

# Introduction

In the previous worksheet, we did a two-factor Bayesian ANOVA where one factor was within-subject and the other was between-subjects. In this worksheet, we'll use the same data frame to illustrate another couple of two-factor ANOVAs.

<a name="start"></a>

# Getting started

We'll be using the same meditation training data we used in [evidence, part 4](anova3.html) exercise, so make sure you've completed that worksheet and have the  `words` data frame from that worksheet in your current R project. If for some reason you do not have that data frame, you can re-create it like this, as long as you have `wordnaming2.csv` in your R project (which is available from the _git_ repository we used [previously](preproc.html#load)):

```{r init, message=FALSE}
library(tidyverse)
library(BayesFactor, quietly = TRUE)
words <- read_csv("wordnaming2.csv")
```

Now, we need to create a subject-level summary file that contains all the factors available in this dataset. This includes two factors we haven't analysed yet - `sex` (biological sex of the participant) and `block` (block of trials in the experiment: 1, 2, 3):

```{r factsum, message=FALSE}
wordsum <- words %>% group_by(subj, sex, medit, congru, block) %>% summarise(rt = mean(rt))
wordsum$sex <- factor(wordsum$sex)
wordsum$subj <- factor(wordsum$subj)
wordsum$medit <- factor(wordsum$medit)
wordsum$congru <- factor(wordsum$congru)
wordsum$block <- factor(wordsum$block)
```

<a name="twoBS"></a>

# Two between-subject factors

We can use `anovaBF` to do a factorial Bayesian ANOVA where both factors are between-subjects. For example, `sex` and `medit`:

```{r bf-2bs}
bf2bs <- anovaBF(formula = rt ~ medit*sex + subj, data = data.frame(wordsum))
```

## Explanation of command

The command is pretty much like a [one-factor between-subjects ANOVA](), we just add the additional factor:

`formula = rt ~ medit*sex` 

This tells `anovaBF` what type of ANOVA we want. It says that the dependent variable is the reaction time column `rt`, and that the independent variables are the training type `medit` and the biological sex of the participant `sex`. The `*` means "do a factorial ANOVA". In other words, it means work out a Bayes Factor for the main effect of each factor, and for the interaction. 

## Explanation of output

Once calculation has finished, take a look at the results. You do this by typing in the name of the object you stored the results in:

```{r reveal}
bf2bs
```

The exact figures in your output may be slightly different to those shown.

The key parts of this output are the Bayes Factors, which are the numbers immediately after the colons. A couple of things to notice here. First, there are four Bayes factors, when we might have expected to see three. We'll come back to that later. Second, there are things like `±2.66%` after the Bayes Factors. This means that R has _estimated_ the Bayes Factors, and is able to tell you how accurate that estimate is. So, for example, `10 ± 10%` means the Bayes Factor is somewhere between 9 and 11. 

We'll look at each of these Bayes factors in turn. Notice they are numbered, e.g. `[1]` - this will become useful later. Also notice that they all include  `+ subj`. This  just indicates that at least one of the factors is within-subjects, so we'll ignore the `+ subj` in our descriptions from here on.

### `[1] sex`

The is the **main effect** of participant sex. More specifically, it is the hypothesis that `sex`  affects `rt`. This is compared against the hypothesis that there is no effect of sex.

The Bayes Factor is about 140,000, strong evidence for  a main effect of sex. We can find out which direction this effect is in like this:

```{r sexME}
wordsum %>% group_by(sex) %>% summarise(mean(rt))
```

Overall, females are around 15 ms slower on this task. This is a small effect in absolute terms, but we have good evidence for it. The result may seem rather surprising, but let's go through the whole analysis before returning to this.

### `[2] medit`

This is the **main effect** of training type, `medit`. More specifically, it is a test of the hypothesis that `medit`, affects `rt`. 

The Bayes Factor for this hypothesis is around $5 \times 10^{23}$, which is really strong evidence that there is a main effect of meditation training. But which direction is the main effect in? Does meditation training make you faster overall, or slower overall?

We can find this out by using the `group_by` and `summarise` commands we have used several times before:

```{r meditME}
wordsum %>% group_by(medit) %>% summarise(mean(rt))
```

From this, we can see that people in the meditation condition are about 30 ms faster, on average, than those in the control condition. Meditation training seems to have led to a reduction in overall reaction times in this task.


As expected, incongruent trials are slower than congruent trials, on average. Again the difference is around 30 ms.

### The interaction

`anovaBF` does not directly give us a Bayes Factor for the interaction of the two main effects. Instead, it gives us two Bayes Factors for things that we can use to work out the interaction BF. These are:

#### [3] `medit + congru`

This the hypothesis that there is a main effect of both factors. There is no assumption that the two main effects are of the same size. This 'main effects' hypothesis is compared against the null hypothesis, i.e. that neither `medit` nor `congru` affect `rt`. 

The BF for this hypothesis is large (about 300,000). We'd expect this, given that there was substantial evidence for both `congru` alone and `medit` alone.

#### [4] medit + congru + medit:congru

This is the Bayes Factor for the hypothesis that there are main effects for both factors (`medit + congru`) _and_ that the two factors interact (`+ medit:congru`). This is again compared against the null hypothesis that neither `medit` nor `congru` have any effect. 

The BF for this hypothesis is also large (about $1.8 \times 10^{9}$). We'd expect this, because there was substantial evidence for the 'main effects' hypothesis `medit + congru`. 

#### Interaction BF

Remember that a Bayes Factor is always a comparison of two types of evidence. So far, we've always compared some experimental hypothesis with  the null hypothesis. But we can also compare the evidence for two different experimental hypotheses. The hypothesis that there is an interaction is the hypothesis that there is something more going on that just the combination of main effects. For example, the hypothesis that the congruency effect is smaller after mediation. So, to get a Bayes Factor for the interaction, we compare the evidence for hypothesis `[4]` with the evidence for hypothesis `[3]`. To do this, we divide the Bayes Factor for `[4]` by the Bayes Factor for `[3]`. 

In R we can use the `bf` object to do this:

```{r int-fact}
bf[4] / bf[3]
```

This gives us a Bayes Factor for the interaction close to 6000. So, there is strong evidence for the interaction, too.


___


This material is distributed under a [Creative Commons](https://creativecommons.org/) licence. CC-BY-SA 4.0. 


